function _defineProperties(l,n){for(var u=0;u<n.length;u++){var t=n[u];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(l,t.key,t)}}function _createClass(l,n,u){return n&&_defineProperties(l.prototype,n),u&&_defineProperties(l,u),l}function _classCallCheck(l,n){if(!(l instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{Ceb0:function(l,n,u){"use strict";u.r(n);var t=u("8Y7J"),e=function l(){_classCallCheck(this,l)},i=u("pMnS"),o=u("oBZk"),r=u("ZZ/e"),s=u("SVse"),c=u("mrSG"),a=u("Z5J9"),b=u("sjK5"),f=u("G+rn"),p=function l(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;_classCallCheck(this,l),this._id=u,this.email=t,this.password=e,this.name=i,this.profilePhoto=o,this.followers=r,this.following=s,this.jwt=n},h=u("25lC"),g=u("TVc2"),m=u("9ldr"),d=function(){function l(n,u,t,e,i,o){_classCallCheck(this,l),this.navCtrl=n,this.userService=u,this.storage=t,this.chatService=e,this.friendsService=i,this.notificationComponent=o}return _createClass(l,[{key:"ngOnInit",value:function(){return c.b(this,void 0,void 0,regeneratorRuntime.mark((function l(){var n=this;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return this.user=JSON.parse(this.storage.getUser()),this.chatService.connectSocket(this.user.name),l.next=4,this.chatService.getStoredMessages().toPromise();case 4:this.storedMessages=l.sent,this.chatService.getList().subscribe((function(l){n.userList=l.filter((function(l){return l[0]!==n.user.name}))})),this.friendsService.getUsers(new p(this.storage.getUser())._id).subscribe((function(l){n.users=l.filter((function(l){return l.name!==n.user.name})),n.users.forEach((function(l){n.userService.getPhoto(l._id).toPromise().then((function(n){l.photo=n.photo}))}))})),this.chatService.forceGetList(),this.chatService.getMessage().subscribe((function(l){n.storedMessages.push(new g.a("",l.name,n.user.name,l.message,new Date,!1,0))}));case 9:case"end":return l.stop()}}),l,this)})))}},{key:"filterAndCount",value:function(l){return this.storedMessages.filter((function(n){return n.author===l&&!1===n.read})).length}},{key:"filterLast",value:function(l){var n=this.storedMessages.filter((function(n){return n.author===l||n.destination===l}));return n[n.length-1]}},{key:"viewConversation",value:function(l){this.navCtrl.navigateForward("/conversation/"+"".concat(l)),this.storedMessages.filter((function(n){return n.author===l})).forEach((function(l){return l.read=!0}))}}]),l}(),v=t.Bb({encapsulation:0,styles:[[""]],data:{}});function C(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),t.Db(1,0,null,null,1,"b",[],null,null,null,null,null)),(l()(),t.Wb(-1,null,["You: "]))],null,null)}function D(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"ion-badge",[["slot","end"]],null,null,null,o.K,o.d)),t.Cb(1,49152,null,0,r.k,[t.j,t.p,t.G],null,null),(l()(),t.Wb(2,0,["",""]))],null,(function(l,n){l(n,2,0,n.component.filterAndCount(n.parent.context.$implicit[0]))}))}function j(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,14,"ion-item",[],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.viewConversation(l.context.$implicit[0])&&t),t}),o.bb,o.u)),t.Cb(1,49152,null,0,r.I,[t.j,t.p,t.G],null,null),(l()(),t.Db(2,0,null,0,2,"ion-avatar",[["slot","start"]],null,null,null,o.I,o.b)),t.Cb(3,49152,null,0,r.g,[t.j,t.p,t.G],null,null),(l()(),t.Db(4,0,null,0,0,"img",[["src","../../../assets/img/default_user.png"]],null,null,null,null,null)),(l()(),t.Db(5,0,null,0,7,"ion-label",[],null,null,null,o.cb,o.v)),t.Cb(6,49152,null,0,r.O,[t.j,t.p,t.G],null,null),(l()(),t.Db(7,0,null,0,1,"h2",[],null,null,null,null,null)),(l()(),t.Wb(8,null,["",""])),(l()(),t.Db(9,0,null,0,3,"h3",[],null,null,null,null,null)),(l()(),t.sb(16777216,null,null,1,null,C)),t.Cb(11,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.Wb(12,null,[" "," "])),(l()(),t.sb(16777216,null,0,1,null,D)),t.Cb(14,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null)],(function(l,n){var u=n.component;l(n,11,0,u.filterLast(n.context.$implicit[0]).author===u.user.name),l(n,14,0,0!=u.filterAndCount(n.context.$implicit[0]))}),(function(l,n){var u=n.component;l(n,8,0,n.context.$implicit[0]),l(n,12,0,u.filterLast(n.context.$implicit[0]).text)}))}function w(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null))],null,(function(l,n){l(n,0,0,t.Hb(1,"",n.parent.context.$implicit.photo,""))}))}function x(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,0,"img",[["src","../../../assets/img/default_user.png"]],null,null,null,null,null))],null,null)}function Y(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),t.Db(1,0,null,null,1,"b",[],null,null,null,null,null)),(l()(),t.Wb(-1,null,["You: "]))],null,null)}function k(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,3,"h3",[],null,null,null,null,null)),(l()(),t.sb(16777216,null,null,1,null,Y)),t.Cb(2,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.Wb(3,null,[" "," "]))],(function(l,n){var u=n.component;l(n,2,0,u.filterLast(n.parent.context.$implicit.name).author===u.user.name)}),(function(l,n){l(n,3,0,n.component.filterLast(n.parent.context.$implicit.name).text)}))}function G(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"ion-badge",[["slot","end"]],null,null,null,o.K,o.d)),t.Cb(1,49152,null,0,r.k,[t.j,t.p,t.G],null,null),(l()(),t.Wb(2,0,["",""]))],null,(function(l,n){l(n,2,0,n.component.filterAndCount(n.parent.context.$implicit.name))}))}function I(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,15,"ion-item",[],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.viewConversation(l.context.$implicit.name)&&t),t}),o.bb,o.u)),t.Cb(1,49152,null,0,r.I,[t.j,t.p,t.G],null,null),(l()(),t.Db(2,0,null,0,5,"ion-avatar",[["slot","start"]],null,null,null,o.I,o.b)),t.Cb(3,49152,null,0,r.g,[t.j,t.p,t.G],null,null),(l()(),t.sb(16777216,null,0,1,null,w)),t.Cb(5,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.sb(16777216,null,0,1,null,x)),t.Cb(7,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.Db(8,0,null,0,5,"ion-label",[],null,null,null,o.cb,o.v)),t.Cb(9,49152,null,0,r.O,[t.j,t.p,t.G],null,null),(l()(),t.Db(10,0,null,0,1,"h2",[],null,null,null,null,null)),(l()(),t.Wb(11,null,["",""])),(l()(),t.sb(16777216,null,0,1,null,k)),t.Cb(13,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.sb(16777216,null,0,1,null,G)),t.Cb(15,16384,null,0,s.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null)],(function(l,n){var u=n.component;l(n,5,0,n.context.$implicit.photo),l(n,7,0,!n.context.$implicit.photo),l(n,13,0,u.filterLast(n.context.$implicit.name)),l(n,15,0,0!=u.filterAndCount(n.context.$implicit.name))}),(function(l,n){l(n,11,0,n.context.$implicit.name)}))}function S(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,10,"ion-header",[],null,null,null,o.Y,o.r)),t.Cb(1,49152,null,0,r.C,[t.j,t.p,t.G],null,null),(l()(),t.Db(2,0,null,0,8,"ion-toolbar",[],null,null,null,o.nb,o.G)),t.Cb(3,49152,null,0,r.Db,[t.j,t.p,t.G],null,null),(l()(),t.Db(4,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,o.M,o.f)),t.Cb(5,49152,null,0,r.m,[t.j,t.p,t.G],null,null),(l()(),t.Db(6,0,null,0,1,"ion-menu-button",[],null,null,null,o.fb,o.z)),t.Cb(7,49152,null,0,r.S,[t.j,t.p,t.G],null,null),(l()(),t.Db(8,0,null,0,2,"ion-title",[],null,null,null,o.mb,o.F)),t.Cb(9,49152,null,0,r.Bb,[t.j,t.p,t.G],null,null),(l()(),t.Wb(-1,0,["Messages"])),(l()(),t.Db(11,0,null,null,15,"ion-content",[],null,null,null,o.V,o.o)),t.Cb(12,49152,null,0,r.v,[t.j,t.p,t.G],null,null),(l()(),t.Db(13,0,null,0,6,"ion-list",[],null,null,null,o.eb,o.w)),t.Cb(14,49152,null,0,r.P,[t.j,t.p,t.G],null,null),(l()(),t.Db(15,0,null,0,2,"ion-list-header",[],null,null,null,o.db,o.x)),t.Cb(16,49152,null,0,r.Q,[t.j,t.p,t.G],null,null),(l()(),t.Wb(-1,0,[" Online "])),(l()(),t.sb(16777216,null,0,1,null,j)),t.Cb(19,278528,null,0,s.i,[t.Y,t.U,t.y],{ngForOf:[0,"ngForOf"]},null),(l()(),t.Db(20,0,null,0,6,"ion-list",[],null,null,null,o.eb,o.w)),t.Cb(21,49152,null,0,r.P,[t.j,t.p,t.G],null,null),(l()(),t.Db(22,0,null,0,2,"ion-list-header",[],null,null,null,o.db,o.x)),t.Cb(23,49152,null,0,r.Q,[t.j,t.p,t.G],null,null),(l()(),t.Wb(-1,0,[" Everybody "])),(l()(),t.sb(16777216,null,0,1,null,I)),t.Cb(26,278528,null,0,s.i,[t.Y,t.U,t.y],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var u=n.component;l(n,19,0,u.userList),l(n,26,0,u.users)}),null)}var N=t.zb("app-message",d,(function(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,1,"app-message",[],null,null,null,S,v)),t.Cb(1,114688,null,0,d,[r.Jb,a.a,h.a,b.a,f.a,m.a],null,null)],(function(l,n){l(n,1,0)}),null)}),{},{},[]),$=u("s7LF"),_=u("iInd"),y=function l(){_classCallCheck(this,l)};u.d(n,"MessagePageModuleNgFactory",(function(){return L}));var L=t.Ab(e,[],(function(l){return t.Mb([t.Nb(512,t.m,t.lb,[[8,[i.a,N]],[3,t.m],t.E]),t.Nb(4608,s.l,s.k,[t.A,[2,s.w]]),t.Nb(4608,$.u,$.u,[]),t.Nb(4608,r.b,r.b,[t.G,t.g]),t.Nb(4608,r.Ib,r.Ib,[r.b,t.m,t.x]),t.Nb(4608,r.Lb,r.Lb,[r.b,t.m,t.x]),t.Nb(1073742336,s.b,s.b,[]),t.Nb(1073742336,$.t,$.t,[]),t.Nb(1073742336,$.i,$.i,[]),t.Nb(1073742336,r.Fb,r.Fb,[]),t.Nb(1073742336,_.p,_.p,[[2,_.u],[2,_.m]]),t.Nb(1073742336,y,y,[]),t.Nb(1073742336,e,e,[]),t.Nb(1024,_.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);