(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{Ceb0:function(l,n,u){"use strict";u.r(n);var t=u("8Y7J");class e{}var i=u("pMnS"),s=u("oBZk"),o=u("ZZ/e"),r=u("SVse"),b=u("mrSG"),a=u("Z5J9"),c=u("sjK5"),p=u("G+rn");class f{constructor(l="",n="",u="",t="",e="",i="",s=null,o=null){this._id=n,this.email=u,this.password=t,this.name=e,this.profilePhoto=i,this.followers=s,this.following=o,this.jwt=l}}var h=u("25lC"),m=u("TVc2"),g=u("9ldr");class d{constructor(l,n,u,t,e,i){this.navCtrl=l,this.userService=n,this.storage=u,this.chatService=t,this.friendsService=e,this.notificationComponent=i}ngOnInit(){return b.b(this,void 0,void 0,(function*(){this.user=JSON.parse(this.storage.getUser()),this.chatService.connectSocket(this.user.name),this.storedMessages=yield this.chatService.getStoredMessages().toPromise(),this.chatService.getList().subscribe(l=>{this.userList=l.filter(l=>l[0]!==this.user.name)}),this.friendsService.getUsers(new f(this.storage.getUser())._id).subscribe(l=>{this.users=l.filter(l=>l.name!==this.user.name),this.users.forEach(l=>{this.userService.getPhoto(l._id).toPromise().then(n=>{l.photo=n.photo})})}),this.chatService.forceGetList(),this.chatService.getMessage().subscribe(l=>{this.storedMessages.push(new m.a("",l.name,this.user.name,l.message,new Date,!1,0))})}))}filterAndCount(l){return this.storedMessages.filter(n=>n.author===l&&!1===n.read).length}filterLast(l){const n=this.storedMessages.filter(n=>n.author===l||n.destination===l);return n[n.length-1]}viewConversation(l){this.navCtrl.navigateForward("/conversation/"+`${l}`),this.storedMessages.filter(n=>n.author===l).forEach(l=>l.read=!0)}}var C=t.Bb({encapsulation:0,styles:[[""]],data:{}});function v(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),t.Db(1,0,null,null,1,"b",[],null,null,null,null,null)),(l()(),t.Wb(-1,null,["You: "]))],null,null)}function D(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"ion-badge",[["slot","end"]],null,null,null,s.K,s.d)),t.Cb(1,49152,null,0,o.k,[t.j,t.p,t.G],null,null),(l()(),t.Wb(2,0,["",""]))],null,(function(l,n){l(n,2,0,n.component.filterAndCount(n.parent.context.$implicit[0]))}))}function j(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,14,"ion-item",[],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.viewConversation(l.context.$implicit[0])&&t),t}),s.bb,s.u)),t.Cb(1,49152,null,0,o.I,[t.j,t.p,t.G],null,null),(l()(),t.Db(2,0,null,0,2,"ion-avatar",[["slot","start"]],null,null,null,s.I,s.b)),t.Cb(3,49152,null,0,o.g,[t.j,t.p,t.G],null,null),(l()(),t.Db(4,0,null,0,0,"img",[["src","../../../assets/img/default_user.png"]],null,null,null,null,null)),(l()(),t.Db(5,0,null,0,7,"ion-label",[],null,null,null,s.cb,s.v)),t.Cb(6,49152,null,0,o.O,[t.j,t.p,t.G],null,null),(l()(),t.Db(7,0,null,0,1,"h2",[],null,null,null,null,null)),(l()(),t.Wb(8,null,["",""])),(l()(),t.Db(9,0,null,0,3,"h3",[],null,null,null,null,null)),(l()(),t.sb(16777216,null,null,1,null,v)),t.Cb(11,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.Wb(12,null,[" "," "])),(l()(),t.sb(16777216,null,0,1,null,D)),t.Cb(14,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null)],(function(l,n){var u=n.component;l(n,11,0,u.filterLast(n.context.$implicit[0]).author===u.user.name),l(n,14,0,0!=u.filterAndCount(n.context.$implicit[0]))}),(function(l,n){var u=n.component;l(n,8,0,n.context.$implicit[0]),l(n,12,0,u.filterLast(n.context.$implicit[0]).text)}))}function Y(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null))],null,(function(l,n){l(n,0,0,t.Hb(1,"",n.parent.context.$implicit.photo,""))}))}function G(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,0,"img",[["src","../../../assets/img/default_user.png"]],null,null,null,null,null))],null,null)}function x(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),t.Db(1,0,null,null,1,"b",[],null,null,null,null,null)),(l()(),t.Wb(-1,null,["You: "]))],null,null)}function I(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,3,"h3",[],null,null,null,null,null)),(l()(),t.sb(16777216,null,null,1,null,x)),t.Cb(2,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.Wb(3,null,[" "," "]))],(function(l,n){var u=n.component;l(n,2,0,u.filterLast(n.parent.context.$implicit.name).author===u.user.name)}),(function(l,n){l(n,3,0,n.component.filterLast(n.parent.context.$implicit.name).text)}))}function w(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,2,"ion-badge",[["slot","end"]],null,null,null,s.K,s.d)),t.Cb(1,49152,null,0,o.k,[t.j,t.p,t.G],null,null),(l()(),t.Wb(2,0,["",""]))],null,(function(l,n){l(n,2,0,n.component.filterAndCount(n.parent.context.$implicit.name))}))}function S(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,15,"ion-item",[],null,[[null,"click"]],(function(l,n,u){var t=!0;return"click"===n&&(t=!1!==l.component.viewConversation(l.context.$implicit.name)&&t),t}),s.bb,s.u)),t.Cb(1,49152,null,0,o.I,[t.j,t.p,t.G],null,null),(l()(),t.Db(2,0,null,0,5,"ion-avatar",[["slot","start"]],null,null,null,s.I,s.b)),t.Cb(3,49152,null,0,o.g,[t.j,t.p,t.G],null,null),(l()(),t.sb(16777216,null,0,1,null,Y)),t.Cb(5,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.sb(16777216,null,0,1,null,G)),t.Cb(7,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.Db(8,0,null,0,5,"ion-label",[],null,null,null,s.cb,s.v)),t.Cb(9,49152,null,0,o.O,[t.j,t.p,t.G],null,null),(l()(),t.Db(10,0,null,0,1,"h2",[],null,null,null,null,null)),(l()(),t.Wb(11,null,["",""])),(l()(),t.sb(16777216,null,0,1,null,I)),t.Cb(13,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null),(l()(),t.sb(16777216,null,0,1,null,w)),t.Cb(15,16384,null,0,r.j,[t.Y,t.U],{ngIf:[0,"ngIf"]},null)],(function(l,n){var u=n.component;l(n,5,0,n.context.$implicit.photo),l(n,7,0,!n.context.$implicit.photo),l(n,13,0,u.filterLast(n.context.$implicit.name)),l(n,15,0,0!=u.filterAndCount(n.context.$implicit.name))}),(function(l,n){l(n,11,0,n.context.$implicit.name)}))}function $(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,10,"ion-header",[],null,null,null,s.Y,s.r)),t.Cb(1,49152,null,0,o.C,[t.j,t.p,t.G],null,null),(l()(),t.Db(2,0,null,0,8,"ion-toolbar",[],null,null,null,s.nb,s.G)),t.Cb(3,49152,null,0,o.Db,[t.j,t.p,t.G],null,null),(l()(),t.Db(4,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,s.M,s.f)),t.Cb(5,49152,null,0,o.m,[t.j,t.p,t.G],null,null),(l()(),t.Db(6,0,null,0,1,"ion-menu-button",[],null,null,null,s.fb,s.z)),t.Cb(7,49152,null,0,o.S,[t.j,t.p,t.G],null,null),(l()(),t.Db(8,0,null,0,2,"ion-title",[],null,null,null,s.mb,s.F)),t.Cb(9,49152,null,0,o.Bb,[t.j,t.p,t.G],null,null),(l()(),t.Wb(-1,0,["Messages"])),(l()(),t.Db(11,0,null,null,15,"ion-content",[],null,null,null,s.V,s.o)),t.Cb(12,49152,null,0,o.v,[t.j,t.p,t.G],null,null),(l()(),t.Db(13,0,null,0,6,"ion-list",[],null,null,null,s.eb,s.w)),t.Cb(14,49152,null,0,o.P,[t.j,t.p,t.G],null,null),(l()(),t.Db(15,0,null,0,2,"ion-list-header",[],null,null,null,s.db,s.x)),t.Cb(16,49152,null,0,o.Q,[t.j,t.p,t.G],null,null),(l()(),t.Wb(-1,0,[" Online "])),(l()(),t.sb(16777216,null,0,1,null,j)),t.Cb(19,278528,null,0,r.i,[t.Y,t.U,t.y],{ngForOf:[0,"ngForOf"]},null),(l()(),t.Db(20,0,null,0,6,"ion-list",[],null,null,null,s.eb,s.w)),t.Cb(21,49152,null,0,o.P,[t.j,t.p,t.G],null,null),(l()(),t.Db(22,0,null,0,2,"ion-list-header",[],null,null,null,s.db,s.x)),t.Cb(23,49152,null,0,o.Q,[t.j,t.p,t.G],null,null),(l()(),t.Wb(-1,0,[" Everybody "])),(l()(),t.sb(16777216,null,0,1,null,S)),t.Cb(26,278528,null,0,r.i,[t.Y,t.U,t.y],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var u=n.component;l(n,19,0,u.userList),l(n,26,0,u.users)}),null)}function N(l){return t.Yb(0,[(l()(),t.Db(0,0,null,null,1,"app-message",[],null,null,null,$,C)),t.Cb(1,114688,null,0,d,[o.Jb,a.a,h.a,c.a,p.a,g.a],null,null)],(function(l,n){l(n,1,0)}),null)}var L=t.zb("app-message",d,N,{},{},[]),M=u("s7LF"),k=u("iInd");class U{}u.d(n,"MessagePageModuleNgFactory",(function(){return W}));var W=t.Ab(e,[],(function(l){return t.Mb([t.Nb(512,t.m,t.lb,[[8,[i.a,L]],[3,t.m],t.E]),t.Nb(4608,r.l,r.k,[t.A,[2,r.w]]),t.Nb(4608,M.u,M.u,[]),t.Nb(4608,o.b,o.b,[t.G,t.g]),t.Nb(4608,o.Ib,o.Ib,[o.b,t.m,t.x]),t.Nb(4608,o.Lb,o.Lb,[o.b,t.m,t.x]),t.Nb(1073742336,r.b,r.b,[]),t.Nb(1073742336,M.t,M.t,[]),t.Nb(1073742336,M.i,M.i,[]),t.Nb(1073742336,o.Fb,o.Fb,[]),t.Nb(1073742336,k.p,k.p,[[2,k.u],[2,k.m]]),t.Nb(1073742336,U,U,[]),t.Nb(1073742336,e,e,[]),t.Nb(1024,k.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);